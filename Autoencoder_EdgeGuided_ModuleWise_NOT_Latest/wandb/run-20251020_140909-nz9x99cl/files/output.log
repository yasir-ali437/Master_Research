Epoch 1/20:  67%|█████████████████████▌          | 31/46 [00:38<00:16,  1.07s/it, grad=0.204, loss=0.1328, ssim_m=0.656]
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
Epoch 2/20:  67%|█████████████████████▌          | 31/46 [00:32<00:15,  1.02s/it, grad=0.153, loss=0.0600, ssim_m=0.461]
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
Epoch 3/20:  67%|█████████████████████▌          | 31/46 [00:33<00:15,  1.03s/it, grad=0.141, loss=0.0453, ssim_m=0.356]
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
Epoch 4/20:  67%|█████████████████████▌          | 31/46 [00:32<00:15,  1.01s/it, grad=0.135, loss=0.0407, ssim_m=0.333]
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 0.9960784316062927
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
Epoch 5/20:  67%|█████████████████████▌          | 31/46 [00:33<00:15,  1.01s/it, grad=0.125, loss=0.0371, ssim_m=0.250]
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
Epoch 6/20:  67%|█████████████████████▌          | 31/46 [00:33<00:15,  1.05s/it, grad=0.122, loss=0.0347, ssim_m=0.247]
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
Epoch 7/20:  67%|█████████████████████▌          | 31/46 [00:33<00:15,  1.05s/it, grad=0.131, loss=0.0339, ssim_m=0.212]
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
Epoch 8/20:  67%|█████████████████████▌          | 31/46 [00:32<00:15,  1.01s/it, grad=0.117, loss=0.0323, ssim_m=0.239]
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
Epoch 9/20:  67%|█████████████████████▌          | 31/46 [00:32<00:16,  1.08s/it, grad=0.130, loss=0.0306, ssim_m=0.227]
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
Epoch 10/20:  65%|████████████████████▏          | 30/46 [00:31<00:16,  1.01s/it, grad=0.127, loss=0.0308, ssim_m=0.201]/data1/yasir/envs/tensor/lib/python3.7/site-packages/geomloss/sinkhorn_divergence.py:150: RuntimeWarning: divide by zero encountered in log
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
PETTTTL :  0.0 1.0
  + [blur ** p]
Epoch 10/20:  65%|████████████████████▏          | 30/46 [00:32<00:17,  1.07s/it, grad=0.127, loss=0.0308, ssim_m=0.201]
Traceback (most recent call last):
  File "train_YCbCr_Outside_penalty.py", line 532, in <module>
    main()
  File "train_YCbCr_Outside_penalty.py", line 511, in main
    loss, terms = loss_fn(fused, mri, pet, mask, edge_pred)
  File "/data1/yasir/envs/tensor/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "train_YCbCr_Outside_penalty.py", line 418, in forward
    L_transport_total += self.sinkhorn(y_i, pet_i)
  File "/data1/yasir/envs/tensor/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/data1/yasir/envs/tensor/lib/python3.7/site-packages/geomloss/samples_loss.py", line 283, in forward
    verbose=self.verbose,
  File "/data1/yasir/envs/tensor/lib/python3.7/site-packages/geomloss/sinkhorn_samples.py", line 192, in sinkhorn_tensorized
    x, y, p, blur, reach, diameter, scaling
  File "/data1/yasir/envs/tensor/lib/python3.7/site-packages/geomloss/sinkhorn_divergence.py", line 163, in scaling_parameters
    eps_list = epsilon_schedule(p, diameter, blur, scaling)
  File "/data1/yasir/envs/tensor/lib/python3.7/site-packages/geomloss/sinkhorn_divergence.py", line 150, in epsilon_schedule
    + [blur ** p]
ValueError: Maximum allowed size exceeded
